(function(){function F(c,g,h,b,k,a){var d=(h-c)/2,f=(k-h)/2;c=Math.atan((h-c)/Math.abs(b-g));k=Math.atan((k-h)/Math.abs(b-a));c=g<b?Math.PI-c:c;k=a<b?Math.PI-k:k;a=Math.PI/2-(c+k)%(2*Math.PI)/2;g=d*Math.sin(a+c);d*=Math.cos(a+c);c=f*Math.sin(a+k);f*=Math.cos(a+k);return{x1:h-g,y1:b+d,x2:h+c,y2:b+f}}var G=/\{([^\}]+)\}/g,H=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,I=function(c,g,h){var b=h;g.replace(H,function(c,a,d,f,g){a=a||f;b&&(a in b&&(b=b[a]),"function"==typeof b&&g&&(b=b()))});
return b=(null==b||b==h?c:b)+""},J=function(c,g){return String(c).replace(G,function(c,b){return I(c,b,g)})};Raphael.fn.drawGrid=function(c,g,h,b,k,a,d){d=d||"#000";a=["M",Math.round(c)+0.5,Math.round(g)+0.5,"L",Math.round(c+h)+0.5,Math.round(g)+0.5,Math.round(c+h)+0.5,Math.round(g+b)+0.5,Math.round(c)+0.5,Math.round(g+b)+0.5,Math.round(c)+0.5,Math.round(g)+0.5];h/=k;for(e=1;e<k;e++)a=a.concat(["M",Math.round(c+e*h)+0.5,Math.round(g)+0.5,"V",Math.round(g+b)+0.5]);return this.path(a.join(",")).attr({stroke:d})};
Raphael.fn.popup=function(c,g,h,b,k){b=String(b||"top-middle").split("-");b[1]=b[1]||"middle";var a=h.getBBox(),d=Math.round(a.width),f=Math.round(a.height),e=Math.round(a.x)-5,a=Math.round(a.y)-5,l=Math.min(f/2,d/2,10),m=[{x:e+5,y:a,w:d,w4:d/4,h4:f/4,right:0,left:d-2*l,bottom:0,top:f-2*l,r:5,h:f,gap:l},{x:e+5,y:a,w:d,w4:d/4,h4:f/4,left:d/2-l,right:d/2-l,top:f/2-l,bottom:f/2-l,r:5,h:f,gap:l},{x:e+5,y:a,w:d,w4:d/4,h4:f/4,left:0,right:d-2*l,top:0,bottom:f-2*l,r:5,h:f,gap:l}]["middle"==b[1]?1:2*("top"==
b[1]||"left"==b[1])],n=0,p=0,q=this.path(J({top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",
left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}[b[0]],m)).insertBefore(h);switch(b[0]){case "top":n=c-(e+5+m.left+l);p=g-(a+5+f+5+l);break;case "bottom":n=c-(e+5+m.left+l);p=g-(a-l);break;case "left":n=c-(e+5+d+5+l);p=g-(a+5+m.top+l);break;case "right":n=c-(e-l),p=g-(a+5+m.top+l)}q.translate(n,p);if(k)return k=q.attr("path"),q.remove(),
{path:k,dx:n,dy:p};h.translate(n,p);return q};var x=[],t=[];jQuery("#ab_chart_data tfoot th").each(function(){x.push(jQuery(this).html())});jQuery("#ab_chart_data tbody td").each(function(){t.push(jQuery(this).html())});var y=jQuery("#ab_chart").parent().width(),n=Raphael("ab_chart",y,140),s=(y-5)/x.length,A=100/Math.max.apply(Math,t);n.drawGrid(5+0.5*s-1,20,y-5-s,100,10,10,"#eaeaea");var K=n.path().attr({stroke:"#3399CC","stroke-width":4,"stroke-linejoin":"round"}),m=n.set(),B=0,C=0,w=!1,D,z=n.set();
m.push(n.text(60,12,"24\u00d7 Spam").attr({font:"bold 10px Helvetica, Arial",fill:"#333"}));m.push(n.text(60,27,"15.08.2013").attr({font:"bold 10px Helvetica, Arial",fill:"#fff"}).attr({fill:"#3399CC"}));m.hide();for(var u=n.popup(100,100,m,"right").attr({fill:"#fff",stroke:"#333","stroke-width":2,"fill-opacity":0.8}).hide(),v,e=0,E=x.length;e<E;e++){var p=Math.round(120-A*t[e]),q=Math.round(5+s*(e+0.5));e||(v=["M",q,p,"C",q,p]);if(e&&e<E-1){var r=Math.round(120-A*t[e-1]),L=Math.round(5+s*(e-0.5)),
M=Math.round(120-A*t[e+1]),N=Math.round(5+s*(e+1.5)),r=F(L,r,q,p,N,M);v=v.concat([r.x1,r.y1,q,p,r.x2,r.y2])}r=n.circle(q,p,4).attr({fill:"#fff",stroke:"#3399CC","stroke-width":2});z.push(n.rect(5+s*e,0,s,120).attr({stroke:"none",fill:"#fff",opacity:0}));var O=z[z.length-1];(function(c,e,h,b,k){O.hover(function(){clearTimeout(D);var a="right";c+u.getBBox().width>y&&(a="left");var d=n.popup(c,e,m,a,1),a=Raphael.animation({path:d.path,transform:["t",d.dx,d.dy]},200*w);B=m[0].transform()[0][1]+d.dx;C=
m[0].transform()[0][2]+d.dy;u.show().stop().animate(a);var f=new Date(1E3*b),d=(10>f.getDate()?"0":"")+f.getDate(),p=(10>f.getMonth()+1?"0":"")+(f.getMonth()+1),f=f.getFullYear();m[0].attr({text:h+"\u00d7 Spam"}).show().stop().animateWith(u,a,{transform:["t",B,C]},200*w);m[1].attr({text:d+"."+p+"."+f}).show().stop().animateWith(u,a,{transform:["t",B,C]},200*w);k.attr("r",6);w=!0},function(){k.attr("r",4);D=setTimeout(function(){u.hide();m[0].hide();m[1].hide();w=!1},1)})})(q,p,t[e],x[e],r)}v=v.concat([q,
p,q,p]);K.attr({path:v});u.toFront();m[0].toFront();m[1].toFront();z.toFront()})();